<!DOCTYPE html>
<html lang="en-US">

<head>
	{% load static %}
	<link rel="stylesheet" href="{% static 'regsys/style.css' %}">
	<meta charset="utf-8" />
	<title>reg-sys-cw: Моё расписание</title>
</head>

<body>
	{% if messages %}
		<div class="messages">
		{% for message in messages %}
			<p{% if message.tags %} class="message_{{ message.tags }}"{% endif %}>{{ message }}</p>
		{% endfor %}
		</div>
	{% endif %}

	<div class="parent">
	
	<div class="navbar">
		{% for name, link in navbar.items %}
			{% if name == "Моё расписание" %}
				<a class="navbar_current" href="{% url link %}">{{ name }}</a>
			{% else %}
				<a class="navbar_link" href="{% url link %}">{{ name }}</a>
			{% endif %}
		{% endfor %}
		</div>
	
		<div class="block">
	<p class="text-h2" style="color: #374B9B">Текущее расписание:</p>
	{% if regs %}
	{% for event, dates in regs.items %}
		{% for date, entries in dates.items %}
			<table>
			<span class="text-body-semibold">{{ event }}: </span><span class="text-body-regular">{{ date }}</span>
			{% for entry in entries %}
				<tr>
				<td class="text-body-regular">{{ entry.category }} - </td>
				<td class="text-body-regular">{{ entry.timetable_name }}</td>
				<td class="text-body-italic" , style="color: #808080;">{{ event.place }}, {{ entry.place }}</td>
				<td class="text-body-italic" , style="color: #808080;">{{ entry.host }}</td>
				</tr>
			{% endfor %}
			</table>
		{% endfor %}
	{% endfor %}
	{% else %}
	<p class="text-body-regular" style="color: #E61E3C;">Кажется, ваше расписание совсем пустое. Попробуйте снова!</p>
	{% endif %}
	<br>
	<form action="{% url 'download' %}" method="get">
		<input type="text" id="guest_id" name="guest_id" value="{{ guest.id }}" hidden>
		<input type="submit" class="secondary-button" value="Скачать расписание в формате .csv">
	</form>
	<br>
		</div>
	</div>
</body>

</html>